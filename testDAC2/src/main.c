#include <stm32f4xx.h>
#include <stdint.h>

const uint16_t sinetable[256] =
		{
				512,524,537,549,562,574,587,599,
				611,624,636,648,660,672,684,696,
				707,719,730,741,753,764,774,785,
				796,806,816,826,836,846,855,864,
				873,882,890,899,907,915,922,930,
				937,944,950,957,963,968,974,979,
				984,989,993,997,1001,1004,1008,1011,
				1013,1015,1017,1019,1021,1022,1022,1023,
				1023,1023,1022,1022,1021,1019,1017,1015,
				1013,1011,1008,1004,1001,997,993,989,
				984,979,974,968,963,957,950,944,
				937,930,922,915,907,899,890,882,
				873,864,855,846,836,826,816,806,
				796,785,774,764,753,741,730,719,
				707,696,684,672,660,648,636,624,
				611,599,587,574,562,549,537,524,
				512,499,486,474,461,449,436,424,
				412,399,387,375,363,351,339,327,
				316,304,293,282,270,259,249,238,
				227,217,207,197,187,177,168,159,
				150,141,133,124,116,108,101,93,
				86,79,73,66,60,55,49,44,
				39,34,30,26,22,19,15,12,
				10,8,6,4,2,1,1,0,
				0,0,1,1,2,4,6,8,
				10,12,15,19,22,26,30,34,
				39,44,49,55,60,66,73,79,
				86,93,101,108,116,124,133,141,
				150,159,168,177,187,197,207,217,
				227,238,249,259,270,282,293,304,
				316,327,339,351,363,375,387,399,
				412,424,436,449,461,474,486,499,

		};

void Delaym(__IO uint32_t delaypar);
void RCC_config(void) {
  SET_BIT(RCC->AHB1ENR, RCC_AHB1ENR_GPIOAEN); // enable the IO port A clock
  SET_BIT(RCC->APB1ENR, RCC_APB1ENR_DACEN);   // enable the DAC clock
}

// GPIO setting
void GPIOA_config(void) {
  SET_BIT(GPIOA->MODER, GPIO_MODER_MODER4);   // PA4 = Analog
}

void DAC_config(void) {
  SET_BIT(DAC->CR, DAC_CR_EN1);
}


int main(void) {
  RCC_config();
  GPIOA_config();
  DAC_config();
  while(1)
  {
	  for (__IO uint16_t i=0;i<256;i++)
	  {
		  DAC->DHR12R1 = sinetable[i];
//		  Delaym(0xFF);
	  }

  }

}

void Delaym(__IO uint32_t delaypar)
{
	while(delaypar--);
}
